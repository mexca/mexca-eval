<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.36">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Eva Viviani">

<title>Mexca performance - video</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="quarto_mexca_performance_video_files/libs/clipboard/clipboard.min.js"></script>
<script src="quarto_mexca_performance_video_files/libs/quarto-html/quarto.js"></script>
<script src="quarto_mexca_performance_video_files/libs/quarto-html/popper.min.js"></script>
<script src="quarto_mexca_performance_video_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="quarto_mexca_performance_video_files/libs/quarto-html/anchor.min.js"></script>
<link href="quarto_mexca_performance_video_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="quarto_mexca_performance_video_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="quarto_mexca_performance_video_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="quarto_mexca_performance_video_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="quarto_mexca_performance_video_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Mexca performance - video</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Eva Viviani </p>
          </div>
  </div>
    
    
  </div>
  

</header>

<div class="cell">

</div>
<p>Mexca’s video subcomponent is based on <a href="https://py-feat.org/pages/intro.html">Py-feat</a>. Py-feat includes pre-trained models for Action Unit detection, emotion detection, Face and Landmark detection and identification.</p>
<p>In this notebook, we evaluate mexca/Py-feat performance on face detection and identification. We aim at answering the following questions:</p>
<ul>
<li><p>Q1: Is performance affected by the number of faces in a video?</p></li>
<li><p>Q2: Is performance influenced by how long one face is presented compared to the others?</p></li>
</ul>
<section id="the-test-dataset" class="level2">
<h2 class="anchored" data-anchor-id="the-test-dataset">The test dataset</h2>
<p>We have applied mexca’s video pipeline on a dataset provided by the project partner. The dataset is made of excerpts of a video lasting ~1:44:00. The excerpts (named ‘shots’ in the annotation file) are ~ 1500 and last from 22 frames to over 1000 frames.</p>
<p>From this dataset, we have created 10 videos lasting from 00:24 to 2:17 and featuring from 1 to 10 individuals.</p>
<p>This is an example of a video featuring two individuals:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>embedr<span class="sc">::</span><span class="fu">embed_video</span>(<span class="st">'total/2_speaker_total.mp4'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<video width="320" height="240" controls=""> <source src="total/2_speaker_total.mp4" type="video/mp4"> Your browser does not support the video tag;  for browser support, please see:  https://www.w3schools.com/tags/tag_video.asp </video>
</div>
</div>
<p>The videos are build by selecting and concatenating shots of the most frequent individuals from 1 to 10, as reported by a human annotator in the reference file loaded below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>camera_shots_annotation <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"camera_shots_annotation.csv"</span>, <span class="at">header =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Each shot is composed of a variable number of frames. The shots are all 25fps, thus a frame is 1/25 = 0.04</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>camera_shots_annotation <span class="sc">|&gt;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(filename) <span class="sc">|&gt;</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">frames =</span> <span class="fu">mean</span>(frames)) <span class="sc">|&gt;</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">seconds =</span> frames <span class="sc">*</span> <span class="fl">0.04</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,053 × 3
   filename            frames seconds
   &lt;chr&gt;                &lt;dbl&gt;   &lt;dbl&gt;
 1 camera shots_Sub_01    180    7.2 
 2 camera shots_Sub_02    291   11.6 
 3 camera shots_Sub_03     29    1.16
 4 camera shots_Sub_04    335   13.4 
 5 camera shots_Sub_05     82    3.28
 6 camera shots_Sub_06    266   10.6 
 7 camera shots_Sub_07     73    2.92
 8 camera shots_Sub_08    291   11.6 
 9 camera shots_Sub_09     74    2.96
10 camera shots_Sub_10    146    5.84
# … with 1,043 more rows</code></pre>
</div>
</div>
<p>The majority of the shots includes annotations of one single person at a time, and of max 3 individuals at a time:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>camera_shots_annotation<span class="sc">$</span>n_faces <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(<span class="sc">!</span><span class="fu">is.na</span>(camera_shots_annotation[,<span class="fu">c</span>(<span class="st">"face_1"</span>, <span class="st">"face_2"</span>, <span class="st">"face_3"</span>)]))</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(camera_shots_annotation<span class="sc">$</span>n_faces)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  0   1   2   3 
151 755  76  71 </code></pre>
</div>
</div>
<p>We can answer Q1 by evaluating mexca’s performance on videos featuring (1) individuals who are alone in the frame, or (2) are together with other people. From the annotation structure above, we know however that for (2) we can evaluate the performance for min = 2 to max = 3 people at a time only.</p>
<p>Among all the individuals, we have excluded individuals who were not frequently annotated. This led us to have 10 people.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(<span class="fu">table</span>(camera_shots_annotation<span class="sc">$</span>face_1), <span class="at">decreasing =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
      Rutte Marijnissen    Hoekstra     Wilders      Klaver        Kaag 
        146         106         102          97          93          86 
      mod_m       mod_f    citizen4    citizen1    citizen3    citizen6 
         61          57          28          27          27          24 
   citizen5  citizen2_f       group  citizen2_m 
         23          20           3           2 </code></pre>
</div>
</div>
</section>
<section id="mexcas-output" class="level2">
<h2 class="anchored" data-anchor-id="mexcas-output">Mexca’s output</h2>
<p>We read in the relevant columns in mexca output which allow us to compute performance for face detection and identification.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>output_files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="st">'output/with_n_clusters/'</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>shot_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>() </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(file <span class="cf">in</span> output_files){</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  ded21 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">paste0</span>(<span class="st">"output/with_n_clusters/"</span>,file),<span class="at">stringsAsFactors =</span> T, <span class="at">header =</span> T, <span class="at">dec =</span> <span class="st">"."</span>, <span class="at">na.strings =</span> <span class="st">' '</span>) </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  ded21 <span class="ot">&lt;-</span> ded21[,<span class="fu">c</span>(<span class="st">"frame"</span>, <span class="st">"time"</span>,<span class="st">"face_prob"</span>, <span class="st">"face_landmarks"</span>, <span class="st">"face_aus"</span>, <span class="st">"face_id"</span>)]</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  ded21 <span class="ot">&lt;-</span> <span class="fu">unpack_face_landmarks</span>(ded21)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  ded21 <span class="ot">&lt;-</span> <span class="fu">unpack_face_aus</span>(ded21)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  ded21 <span class="ot">&lt;-</span> ded21 <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">filter_all</span>(dplyr<span class="sc">::</span><span class="fu">any_vars</span>(<span class="sc">!</span><span class="fu">is.na</span>(.)))</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  ded21<span class="sc">$</span>file <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(file); </span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  shot_df <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(shot_df, ded21)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>shot_df <span class="ot">&lt;-</span> <span class="fu">unique</span>(shot_df)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(shot_df[,<span class="fu">c</span>(<span class="st">"frame"</span>,<span class="st">"time"</span>,<span class="st">"face_id"</span>,<span class="st">"face_prob"</span>,<span class="st">"file"</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  frame       time face_id face_prob                       file
1     0 0.00000000       0 0.9934897 1_speaker_contemporary.csv
2     1 0.03987241       0 0.9980152 1_speaker_contemporary.csv
3     2 0.07974482       0 0.9994476 1_speaker_contemporary.csv
4     3 0.11961722       0 0.9989092 1_speaker_contemporary.csv
5     4 0.15948963       0 0.9984949 1_speaker_contemporary.csv
6     5 0.19936204       0 0.9985183 1_speaker_contemporary.csv</code></pre>
</div>
</div>
<p>We add to mexca’s output the column <code>shot_id</code> and <code>filename</code> indicating the shots that made each video in the file/<code>video_name</code> column. Moreover, we also add in the column <code>n</code> the order in which the shots were concatenated. This info is useful in order to understand who was displayed when.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>input_files <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">list.files</span>(<span class="st">'total'</span>, <span class="at">full.names =</span> T), <span class="fu">list.files</span>(<span class="st">'contemporary'</span>, <span class="at">full.names =</span> T))</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>input_files <span class="ot">&lt;-</span> input_files[<span class="fu">grepl</span>(<span class="st">'.txt'</span>, input_files)]</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>input_files <span class="ot">&lt;-</span> input_files[<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">'3_speaker_contemporary.txt|2_speaker_contemporary.txt'</span>, input_files)]</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>final <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(file <span class="cf">in</span> input_files){</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  shot_numbers <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  file_names <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  input <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(file, <span class="at">header =</span> F) </span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  shot_numbers_ <span class="ot">&lt;-</span> <span class="fu">regmatches</span>(input<span class="sc">$</span>V1, <span class="fu">gregexpr</span>(<span class="st">"[[:digit:]]+"</span>, input<span class="sc">$</span>V1))</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  file_names <span class="ot">&lt;-</span> <span class="fu">append</span>(file_names, <span class="fu">paste0</span>(<span class="fu">gsub</span>(<span class="st">"contemporary/|total/|.txt"</span>,<span class="st">""</span>,file),<span class="st">".csv"</span>))</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(shot_numbers_)){</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    shot_numbers <span class="ot">&lt;-</span> <span class="fu">append</span>(shot_numbers, shot_numbers_[[i]][<span class="dv">2</span>])</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">video_name =</span> file_names, <span class="at">shot_id =</span> shot_numbers, </span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>                     <span class="at">filename =</span> <span class="fu">paste0</span>(<span class="st">'camera shots_Sub_'</span>,shot_numbers),</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>                     <span class="at">n =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(shot_numbers_))</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>  final <span class="ot">&lt;-</span> <span class="fu">rbind</span>(final, temp); <span class="fu">rm</span>(temp)</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>final<span class="sc">$</span>video_name <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(final<span class="sc">$</span>video_name); final<span class="sc">$</span>shot_id <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(final<span class="sc">$</span>shot_id); final<span class="sc">$</span>filename <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(final<span class="sc">$</span>filename)</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(final)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                video_name    shot_id                       filename 
 10_speaker_total.csv:20   Min.   :  11.0   camera shots_Sub_120: 2  
 9_speaker_total.csv :18   1st Qu.: 309.5   camera shots_Sub_300: 2  
 8_speaker_total.csv :16   Median : 541.0   camera shots_Sub_304: 2  
 7_speaker_total.csv :14   Mean   : 540.5   camera shots_Sub_496: 2  
 6_speaker_total.csv :12   3rd Qu.: 811.8   camera shots_Sub_515: 2  
 5_speaker_total.csv :10   Max.   :1050.0   camera shots_Sub_601: 2  
 (Other)             :20                    (Other)             :98  
       n       
 Min.   : 1.0  
 1st Qu.: 3.0  
 Median : 7.0  
 Mean   : 7.5  
 3rd Qu.:11.0  
 Max.   :20.0  
               </code></pre>
</div>
</div>
<p>Adding the <code>filename</code> and <code>shot_id</code> columns allow us to merge the annotation file with the info abour mexca’s video. We save this new annotation dataframe as <code>video_annotation</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>video_annotation <span class="ot">&lt;-</span><span class="fu">merge</span>(camera_shots_annotation, final, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'filename'</span>, <span class="st">'shot_id'</span>))</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>video_annotation <span class="ot">&lt;-</span> video_annotation[,<span class="fu">c</span>(<span class="st">'filename'</span>,<span class="st">'n'</span>,<span class="st">'face_1'</span>,<span class="st">'face_2'</span>,<span class="st">'face_3'</span>,<span class="st">'b_frame'</span>,<span class="st">'duration'</span>,<span class="st">'end_frame'</span>,<span class="st">'video_name'</span>, <span class="st">'frames'</span>)]</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(video_annotation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               filename  n      face_1 face_2 face_3             b_frame
1 camera shots_Sub_1020  7 Marijnissen   &lt;NA&gt;   &lt;NA&gt; 2022-10-24 01:41:01
2 camera shots_Sub_1032  2        Kaag   &lt;NA&gt;   &lt;NA&gt; 2022-10-24 01:41:50
3 camera shots_Sub_1038 10     Wilders   &lt;NA&gt;   &lt;NA&gt; 2022-10-24 01:42:33
4 camera shots_Sub_1047  8        Kaag   &lt;NA&gt;   &lt;NA&gt; 2022-10-24 01:43:29
5 camera shots_Sub_1050  8 Marijnissen   &lt;NA&gt;   &lt;NA&gt; 2022-10-24 01:43:41
6   camera shots_Sub_11  4 Marijnissen   &lt;NA&gt;   &lt;NA&gt; 2022-10-24 00:01:10
  duration           end_frame           video_name frames
1     4.00 2022-10-24 01:41:05  6_speaker_total.csv    145
2     3.84 2022-10-24 01:41:54  5_speaker_total.csv     90
3     4.13 2022-10-24 01:42:37  5_speaker_total.csv    167
4     3.99 2022-10-24 01:43:33 10_speaker_total.csv     99
5     2.10 2022-10-24 01:43:43  8_speaker_total.csv     60
6    10.89 2022-10-24 00:01:21  4_speaker_total.csv    264</code></pre>
</div>
</div>
<p>We now have a long dataframe format, however for our analysis is easier to handle a wide format, so we change it to get a row frame by frame. This is how it looks like now:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>video_annotation_wide <span class="ot">&lt;-</span> <span class="fu">pivot_wider_video_annotation</span>(video_annotation)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(video_annotation_wide[,<span class="fu">c</span>(<span class="st">"filename"</span>,<span class="st">"face_1"</span>,<span class="st">"frame"</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 filename   face_1 frame
79   camera shots_Sub_691 Hoekstra     0
79.1 camera shots_Sub_691 Hoekstra     1
79.2 camera shots_Sub_691 Hoekstra     2
79.3 camera shots_Sub_691 Hoekstra     3
79.4 camera shots_Sub_691 Hoekstra     4
79.5 camera shots_Sub_691 Hoekstra     5</code></pre>
</div>
</div>
<p>The names of the people displayed in the video are in the <code>face_1</code> column. These are character strings of the real names of the dutch politicians within the video. Mexca, however, won’t know their real name, and will label them with numbers going from 0 (i.e., 1 person) to 9 (i.e., 10 people).</p>
<p>How can we establish the correspondence between the labels given by the model (i.e., the numbers) and the labels given by the human annotator?</p>
<p>We solve this <a href="https://en.wikipedia.org/wiki/Assignment_problem">assignment problem</a> by first using the custom made <code>add_face_id_to_reference</code> function to convert all names within video file into its corresponding number (e.g., in the video with two speakers, Rutte and Klaver will be 0 and 1, respectively). We append this info in the <code>face_label</code> column.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>video_annotation_wide_labeled <span class="ot">&lt;-</span> <span class="fu">add_face_id_to_reference</span>(video_annotation_wide)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(video_annotation_wide_labeled[,<span class="fu">c</span>(<span class="st">"filename"</span>,<span class="st">"face_1"</span>,<span class="st">"frame"</span>,<span class="st">"face_label"</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 filename   face_1 frame face_label
79   camera shots_Sub_691 Hoekstra     0          0
79.1 camera shots_Sub_691 Hoekstra     1          0
79.2 camera shots_Sub_691 Hoekstra     2          0
79.3 camera shots_Sub_691 Hoekstra     3          0
79.4 camera shots_Sub_691 Hoekstra     4          0
79.5 camera shots_Sub_691 Hoekstra     5          0</code></pre>
</div>
</div>
<p>We then now use the custom made <code>minMatching</code> function to find the optimal mapping between the integer labels from the reference and the integer labels from the model. The optimal mapping is done by the function <code>lp.assign</code> of the <code>lpSolve</code> package which has been designed specifically for solving assignment problems between integer vectors. Under the hood, it implements a variation of the <a href="https://en.wikipedia.org/wiki/Hungarian_algorithm">hungarian method</a>.</p>
<p>Once found the optimal match, we store the reference’s mapping that best match the mexca’s mapping (column <code>face_id</code>) into the column <code>mapped_reference</code>. We save this new file as <code>mexca_opt_mapping</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#simplify mexca's output by selecting only the relevant columns</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(shot_df)[<span class="fu">colnames</span>(shot_df)<span class="sc">==</span><span class="st">"file"</span>] <span class="ot">&lt;-</span> <span class="st">'video_name'</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>mexca_video_output <span class="ot">&lt;-</span> shot_df[,<span class="fu">c</span>(<span class="st">'frame'</span>,<span class="st">'face_id'</span>,<span class="st">'video_name'</span>)]</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">merge</span>(video_annotation_wide_labeled, <span class="fu">na.omit</span>(mexca_video_output), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"video_name"</span>, <span class="st">"frame"</span>), <span class="at">all =</span> <span class="cn">FALSE</span>) <span class="ot">-&gt;</span> temp</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(temp<span class="sc">$</span>video_name) <span class="ot">-&gt;</span> videos</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>mexca_opt_mapping <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (video <span class="cf">in</span> videos){</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  sub_temp <span class="ot">&lt;-</span> <span class="fu">droplevels</span>(temp[temp<span class="sc">$</span>video_name <span class="sc">==</span> video,])</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  mapping <span class="ot">&lt;-</span> <span class="fu">minMatching</span>(<span class="at">reference =</span> sub_temp<span class="sc">$</span>face_label,</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>                         <span class="at">model =</span> sub_temp<span class="sc">$</span>face_id)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># init the column</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  sub_temp<span class="sc">$</span>mapped_reference <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>  optimal_labels <span class="ot">&lt;-</span> <span class="fu">colnames</span>(mapping)[<span class="fu">max.col</span>(mapping, <span class="st">"first"</span>)]</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(x <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(optimal_labels)){</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>    sub_temp[sub_temp<span class="sc">$</span>face_label <span class="sc">==</span> x<span class="dv">-1</span> ,]<span class="sc">$</span>mapped_reference <span class="ot">&lt;-</span> optimal_labels[x] </span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>  mexca_opt_mapping <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(mexca_opt_mapping, sub_temp)</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>mexca_opt_mapping<span class="sc">$</span>mapped_reference <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(mexca_opt_mapping<span class="sc">$</span>mapped_reference)</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mexca_opt_mapping[, <span class="fu">c</span>(<span class="st">"video_name"</span>,<span class="st">"face_1"</span>,<span class="st">"face_id"</span>,<span class="st">"mapped_reference"</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  video_name face_1 face_id mapped_reference
1 1_speaker_contemporary.csv  Rutte       0                0
2 1_speaker_contemporary.csv  Rutte       0                0
3 1_speaker_contemporary.csv  Rutte       0                0
4 1_speaker_contemporary.csv  Rutte       0                0
5 1_speaker_contemporary.csv  Rutte       0                0
6 1_speaker_contemporary.csv  Rutte       0                0</code></pre>
</div>
</div>
<p>We are now ready to compute our performance scores. We are mainly interested in the <a href="https://en.wikipedia.org/wiki/F-score">f1 score</a> per individual, but we will also get the total accuracy per video. In R, the <code>caret</code> package takes care of computing these metrics, and so we will be using it. Note that for the video whereby there is only 1 speaker, the f1 score will be equivalent to the Accuracy score (i.e., they are synonyms) and it will inevitably be 1 (i.e., 100% accuracy). For the video with two speakers, we will get only 1 f1 score, as the classification is binary (i.e., either 0 or 1). We will get multiple f1_scores per individual from n &gt; 3. We save these results into one single file named <code>video_performance</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>videos <span class="ot">&lt;-</span> <span class="fu">unique</span>(mexca_opt_mapping<span class="sc">$</span>video_name)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>video_performance <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(video <span class="cf">in</span> videos){</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  sub_video <span class="ot">&lt;-</span> <span class="fu">droplevels</span>(mexca_opt_mapping[mexca_opt_mapping<span class="sc">$</span>video_name <span class="sc">==</span> video,]) </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  mapping <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">table</span>(sub_video<span class="sc">$</span>face_1, sub_video<span class="sc">$</span>mapped_reference))</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  mapping <span class="ot">&lt;-</span> <span class="fu">subset</span>(mapping, Freq <span class="sc">&gt;</span><span class="dv">1</span>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(mapping) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"true_label"</span>,<span class="st">"mapped_ref"</span>,<span class="st">"Freq"</span>)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  mapping <span class="ot">&lt;-</span> mapping[,<span class="fu">c</span>(<span class="st">"true_label"</span>,<span class="st">"mapped_ref"</span>)]</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">postResample</span>(<span class="at">pred =</span> <span class="fu">as.factor</span>(sub_video<span class="sc">$</span>mapped_reference), <span class="at">obs =</span> <span class="fu">as.factor</span>(sub_video<span class="sc">$</span>face_id))</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  f1_by_speaker <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span>(video <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"2_speaker_total.csv"</span>,  <span class="st">"1_speaker_contemporary.csv"</span>))){</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>    f1_by_speaker <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">confusionMatrix</span>(<span class="fu">as.factor</span>(sub_video<span class="sc">$</span>face_id), <span class="fu">as.factor</span>(sub_video<span class="sc">$</span>mapped_reference), <span class="at">mode =</span> <span class="st">"prec_recall"</span>)<span class="sc">$</span>byClass[,<span class="st">"F1"</span>]</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(f1_by_speaker)[<span class="fu">which</span>(<span class="fu">names</span>(f1_by_speaker) <span class="sc">==</span> <span class="fu">paste0</span>(<span class="st">"Class: "</span>,mapping<span class="sc">$</span>mapped_ref))] <span class="ot">&lt;-</span> <span class="fu">as.character</span>(mapping<span class="sc">$</span>true_label)</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(result) <span class="sc">|&gt;</span> </span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>    tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"score"</span>) <span class="sc">|&gt;</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>( <span class="at">names_from =</span> score, <span class="at">values_from =</span> result)</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(f1_by_speaker)){</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>    result <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(result, f1_by_speaker)</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>    result<span class="sc">$</span>speaker <span class="ot">&lt;-</span> <span class="fu">names</span>(f1_by_speaker)</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(result)[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="st">"f1_score"</span></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>  result<span class="sc">$</span>video_name <span class="ot">&lt;-</span> video</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>  video_performance <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(video_performance, result)</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
New names:
New names:
New names:
New names:
New names:
New names:
New names:
• `` -&gt; `...3`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>video_performance[video_performance<span class="sc">$</span>video_name <span class="sc">==</span> <span class="st">"1_speaker_contemporary.csv"</span>,]<span class="sc">$</span>speaker <span class="ot">&lt;-</span> <span class="st">"Rutte"</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>video_performance[video_performance<span class="sc">$</span>video_name <span class="sc">==</span> <span class="st">"1_speaker_contemporary.csv"</span>,]<span class="sc">$</span>f1_score <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>video_performance[video_performance<span class="sc">$</span>video_name <span class="sc">==</span> <span class="st">"2_speaker_total.csv"</span>,]<span class="sc">$</span>speaker <span class="ot">&lt;-</span> <span class="st">"Klaver"</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>video_performance[video_performance<span class="sc">$</span>video_name <span class="sc">==</span> <span class="st">"2_speaker_total.csv"</span>,]<span class="sc">$</span>f1_score <span class="ot">&lt;-</span> <span class="fu">unique</span>(video_performance[video_performance<span class="sc">$</span>video_name <span class="sc">==</span> <span class="st">"2_speaker_total.csv"</span>,]<span class="sc">$</span>Accuracy)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>video_performance <span class="ot">&lt;-</span> video_performance <span class="sc">|&gt;</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">add_row</span>(<span class="at">Accuracy =</span> video_performance[video_performance<span class="sc">$</span>video_name <span class="sc">==</span> <span class="st">"2_speaker_total.csv"</span>,]<span class="sc">$</span>Accuracy,</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">Kappa =</span> video_performance[video_performance<span class="sc">$</span>video_name <span class="sc">==</span> <span class="st">"2_speaker_total.csv"</span>,]<span class="sc">$</span>Kappa,</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">video_name =</span> <span class="st">"2_speaker_total.csv"</span>,</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">f1_score =</span> <span class="fu">unique</span>(video_performance[video_performance<span class="sc">$</span>video_name <span class="sc">==</span> <span class="st">"2_speaker_total.csv"</span>,]<span class="sc">$</span>Accuracy),</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">speaker =</span> <span class="st">"Rutte"</span>)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(video_performance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  Accuracy  Kappa video_name                 f1_score speaker    
     &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;                         &lt;dbl&gt; &lt;chr&gt;      
1    1     NA     1_speaker_contemporary.csv    1     Rutte      
2    0.732  0.692 10_speaker_total.csv          0.941 citizen4   
3    0.732  0.692 10_speaker_total.csv          0.759 mod_f      
4    0.732  0.692 10_speaker_total.csv          0.572 Rutte      
5    0.732  0.692 10_speaker_total.csv          0.574 Kaag       
6    0.732  0.692 10_speaker_total.csv          0.992 Marijnissen</code></pre>
</div>
</div>
<p>At this point we’re ready to add these metrics to mexca’s video performance dataframe. This way we will get the metrics, the n of speakers and the n of frames they are presented all in the same dataframe.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>table_frames <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(frames <span class="sc">~</span> video_name <span class="sc">+</span> face_1, <span class="at">data =</span> mexca_opt_mapping, unique)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>table_frames<span class="sc">$</span>tot_frames <span class="ot">&lt;-</span> table_frames<span class="sc">$</span>frames[,<span class="dv">1</span>] <span class="sc">+</span> table_frames<span class="sc">$</span>frames[,<span class="dv">2</span>] </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(table_frames)[<span class="fu">colnames</span>(table_frames) <span class="sc">==</span> <span class="st">"face_1"</span>] <span class="ot">&lt;-</span> <span class="st">"speaker"</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>mexca_video_performance <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(video_performance, table_frames[,<span class="fu">c</span>(<span class="st">"video_name"</span>,<span class="st">"speaker"</span>,<span class="st">"tot_frames"</span>)], <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"video_name"</span>,<span class="st">"speaker"</span>))</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>mexca_video_performance <span class="ot">&lt;-</span> mexca_video_performance <span class="sc">|&gt;</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(video_name) <span class="sc">|&gt;</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">n =</span> dplyr<span class="sc">::</span><span class="fu">n</span>())</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>mexca_video_performance <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(mexca_video_performance) <span class="co">#there are na's for those individuals that mexca did not find</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mexca_video_performance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
# Groups:   video_name [1]
  Accuracy Kappa video_name           f1_score speaker     tot_frames     n
     &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;                   &lt;dbl&gt; &lt;chr&gt;            &lt;int&gt; &lt;int&gt;
1    0.732 0.692 10_speaker_total.csv   0.941  citizen4           191    10
2    0.732 0.692 10_speaker_total.csv   0.759  mod_f             1402    10
3    0.732 0.692 10_speaker_total.csv   0.572  Rutte              173    10
4    0.732 0.692 10_speaker_total.csv   0.574  Kaag               170    10
5    0.732 0.692 10_speaker_total.csv   0.992  Marijnissen        193    10
6    0.732 0.692 10_speaker_total.csv   0.0244 Hoekstra           158    10</code></pre>
</div>
</div>
<p>We’re ready now to analyse our results.</p>
<section id="f1-score-distribution" class="level3">
<h3 class="anchored" data-anchor-id="f1-score-distribution">f1 score distribution</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(mexca_video_performance, ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="fu">as.factor</span>(n), f1_score)) <span class="sc">+</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_violin</span>(<span class="at">fill =</span> <span class="st">"lightgray"</span>, <span class="at">col =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  ggforce<span class="sc">::</span><span class="fu">geom_sina</span>(<span class="at">shape =</span> <span class="dv">21</span>)<span class="sc">+</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_y_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.2</span>), <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ylab</span>(<span class="st">"f1 score"</span>) <span class="sc">+</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">xlab</span>(<span class="st">"number of people displayed"</span>) <span class="sc">+</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">round</span>(<span class="fu">mean</span>(mexca_video_performance<span class="sc">$</span>f1_score),<span class="dv">2</span>), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="quarto_mexca_performance_video_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="partial-residual-plot" class="level3">
<h3 class="anchored" data-anchor-id="partial-residual-plot">Partial residual plot</h3>
<p>We isolate the contribution of the <code>number of faces</code> and <code>frames</code> (i.e., how long a face is displayed) by combining the prediction based on a single predictor (columns: n, tot_frames) with the actual residual from the full regression equation. Note that because of the skewed distribution in the n.&nbsp;of frames, we use a polynomial regression.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>lm_ded21 <span class="ot">&lt;-</span> <span class="fu">lm</span>(f1_score <span class="sc">~</span> n <span class="sc">+</span> <span class="fu">poly</span>(tot_frames, <span class="dv">3</span>), <span class="at">data =</span> mexca_video_performance)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(lm_ded21)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: f1_score
                    Df  Sum Sq  Mean Sq F value  Pr(&gt;F)  
n                    1 0.02388 0.023880   0.498 0.48395  
poly(tot_frames, 3)  3 0.52020 0.173402   3.616 0.01995 *
Residuals           46 2.20591 0.047955                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>terms <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_ded21, <span class="at">type =</span> <span class="st">"terms"</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>partial_resid <span class="ot">&lt;-</span> <span class="fu">resid</span>(lm_ded21) <span class="sc">+</span> terms <span class="co"># a partial residual is the ordinary residual plus the regression term associated with it</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>df_n <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> mexca_video_performance[, <span class="st">"n"</span>],</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Terms =</span> terms[, <span class="st">"n"</span>],</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">PartialResid =</span> partial_resid[, <span class="st">"n"</span>]</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>df_frames <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> mexca_video_performance[, <span class="st">"tot_frames"</span>],</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Terms =</span> terms[, <span class="st">"poly(tot_frames, 3)"</span>],</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">PartialResid =</span> partial_resid[, <span class="st">"poly(tot_frames, 3)"</span>]</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>p[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(df_n, ggplot2<span class="sc">::</span><span class="fu">aes</span>(n, PartialResid)) <span class="sc">+</span> </span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_shape</span>(<span class="at">solid =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_smooth</span>(<span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_line</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(n, Terms)) <span class="sc">+</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title=</span><span class="st">"number of speakers"</span>)</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>p[[<span class="dv">2</span>]] <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(df_frames, ggplot2<span class="sc">::</span><span class="fu">aes</span>(tot_frames, PartialResid)) <span class="sc">+</span> </span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_shape</span>(<span class="at">solid =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_smooth</span>(<span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_line</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(tot_frames, Terms)) <span class="sc">+</span></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title=</span><span class="st">"number of frames"</span>) </span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a><span class="fu">do.call</span>(gridExtra<span class="sc">::</span>grid.arrange,p) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula 'y ~ x'
`geom_smooth()` using method = 'loess' and formula 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="quarto_mexca_performance_video_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="confusion-matrices" class="level3">
<h3 class="anchored" data-anchor-id="confusion-matrices">Confusion matrices</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">unique</span>(mexca_opt_mapping<span class="sc">$</span>video_name)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> x[gtools<span class="sc">::</span><span class="fu">mixedorder</span>(<span class="fu">as.character</span>(x))]</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)){</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  sub_video <span class="ot">&lt;-</span> <span class="fu">droplevels</span>(mexca_opt_mapping[mexca_opt_mapping<span class="sc">$</span>video_name <span class="sc">==</span> x[i],]) </span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  mapping <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">table</span>(sub_video<span class="sc">$</span>face_1, sub_video<span class="sc">$</span>mapped_reference))</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  mapping <span class="ot">&lt;-</span> <span class="fu">subset</span>(mapping, Freq <span class="sc">&gt;</span><span class="dv">1</span>)</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(mapping) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"true_label"</span>,<span class="st">"mapped_ref"</span>,<span class="st">"Freq"</span>)</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  mapping <span class="ot">&lt;-</span> mapping[,<span class="fu">c</span>(<span class="st">"true_label"</span>,<span class="st">"mapped_ref"</span>)]</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  confusion_matrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">table</span>(sub_video<span class="sc">$</span>face_id, sub_video<span class="sc">$</span>mapped_reference))</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(confusion_matrix)[<span class="fu">which</span>(<span class="fu">colnames</span>(confusion_matrix) <span class="sc">==</span> mapping<span class="sc">$</span>mapped_ref)] <span class="ot">&lt;-</span> <span class="fu">as.character</span>(mapping<span class="sc">$</span>true_label)</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames</span>(confusion_matrix)[<span class="fu">which</span>(<span class="fu">rownames</span>(confusion_matrix) <span class="sc">==</span> mapping<span class="sc">$</span>mapped_ref)] <span class="ot">&lt;-</span> <span class="fu">as.character</span>(mapping<span class="sc">$</span>true_label)</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>  p[[i]]<span class="ot">&lt;-</span> confusion_matrix<span class="sc">|&gt;</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>()<span class="sc">|&gt;</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(Var1, Var2, <span class="at">fill =</span> Freq)) <span class="sc">+</span> </span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_tile</span>(</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">colour =</span> <span class="st">"white"</span>,</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="fl">0.1</span>,</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">linetype =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_text</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(Freq,<span class="dv">1</span>))) <span class="sc">+</span></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">scale_fill_gradient</span>(<span class="at">low=</span><span class="st">"white"</span>, <span class="at">high=</span><span class="st">"#009194"</span>)<span class="sc">+</span></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">coord_fixed</span>()<span class="sc">+</span></span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">guides</span>(<span class="at">fill =</span> ggplot2<span class="sc">::</span><span class="fu">guide_colourbar</span>(<span class="at">title =</span> <span class="st">"Frames"</span>))<span class="sc">+</span></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ylab</span>(<span class="st">"True speaker label"</span>)<span class="sc">+</span></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">xlab</span>(<span class="st">"Predicted speaker label"</span>)<span class="sc">+</span></span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">"n = "</span>, i), <span class="at">caption=</span><span class="st">"Dutch debate dataset 2021"</span>)<span class="sc">+</span></span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"right"</span>)</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>){</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(p[[i]])</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel" data-fig.ncol="2">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="quarto_mexca_performance_video_files/figure-html/figures-side-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="quarto_mexca_performance_video_files/figure-html/figures-side-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="quarto_mexca_performance_video_files/figure-html/figures-side-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="quarto_mexca_performance_video_files/figure-html/figures-side-4.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="quarto_mexca_performance_video_files/figure-html/figures-side-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="quarto_mexca_performance_video_files/figure-html/figures-side-6.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="quarto_mexca_performance_video_files/figure-html/figures-side-7.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="quarto_mexca_performance_video_files/figure-html/figures-side-8.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="quarto_mexca_performance_video_files/figure-html/figures-side-9.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="quarto_mexca_performance_video_files/figure-html/figures-side-10.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="q1-is-performance-affected-by-the-number-of-faces-in-a-video" class="level2">
<h2 class="anchored" data-anchor-id="q1-is-performance-affected-by-the-number-of-faces-in-a-video">Q1: Is performance affected by the number of faces in a video?</h2>
<p><code>Answer:</code> No.&nbsp;Performance is constant across speakers (i.e., it is not influenced by n).</p>
</section>
<section id="q2-is-performance-influenced-by-how-long-one-face-is-presented-compared-to-the-others" class="level2">
<h2 class="anchored" data-anchor-id="q2-is-performance-influenced-by-how-long-one-face-is-presented-compared-to-the-others">Q2: Is performance influenced by how long one face is presented compared to the others?</h2>
<p><code>Answer</code>: Yes. Performance is variable for very short segments (i.e., &lt;100 frames, less than 4s) but it reaches a plateau from 250 frames (i.e., 10s).</p>
<p><code>Conclusion:</code> Our results suggest that the video pipeline can be safely used for any number of speaker (up to the tested number of 10) without decreasing in performance, as long as they speak for at least 12s.</p>
<section id="section" class="level3">
<h3 class="anchored" data-anchor-id="section"></h3>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>